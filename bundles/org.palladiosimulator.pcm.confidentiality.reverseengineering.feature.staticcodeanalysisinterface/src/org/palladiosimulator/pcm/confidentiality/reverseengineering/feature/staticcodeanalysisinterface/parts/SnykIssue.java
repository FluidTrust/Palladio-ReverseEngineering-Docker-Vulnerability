package org.palladiosimulator.pcm.confidentiality.reverseengineering.feature.staticcodeanalysisinterface.parts;

import java.util.Date;
import java.util.Map;

import org.palladiosimulator.pcm.confidentiality.reverseengineering.feature.staticcodeanalysisinterface.parts.interfaces.ISevertity;
import org.palladiosimulator.pcm.confidentiality.reverseengineering.feature.staticcodeanalysisinterface.parts.interfaces.IStaticCodeAnalysisIssue;

public class SnykIssue implements IStaticCodeAnalysisIssue{

	private static long nextId = 0;
	private long id = nextId++;
	
	private String url;
	private String title;
	private String packageWithIssue;
	private SnykSeverity severity;
	
	public SnykIssue(String url, String title, String packageWithIssue, SnykSeverity severity) {
		this.url = url;
		this.title = title;
		this.packageWithIssue = packageWithIssue;
		this.severity = severity;
	}
	
	public SnykIssue(String url, String title, String packageWithIssue, String severity) {
		this.url = url;
		this.title = title;
		this.packageWithIssue = packageWithIssue;
		this.severity = SnykSeverity.parseSeverity(severity);
	}
	
	
	@Override
	public long getId() {
		return this.id;
	}

	@Override
	public String getUrl() {
		return this.url;
	}

	@Override
	public String getTitle() {
		return this.title;
	}

	@Override
	public String[] getPaths() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String getPackage() {
		return this.packageWithIssue;
	}

	@Override
	public String getPackageVersion() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public ISevertity getSeverity() {
		return this.severity;
	}

	@Override
	public String getLanguage() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public Date getPublicationTime() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public Date getDisclosureTime() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String getDescription() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public Map<String, String> getIdentifiers() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String getCVSSv3() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public float getCVSSScore() {
		// TODO Auto-generated method stub
		return 0;
	}

	@Override
	public String toString() {
		return String.format("%s (%s Severity) in %s", this.title, this.severity.toString(), this.packageWithIssue);
	}
}
